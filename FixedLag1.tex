A basic filter, the Kalman filter included, allows us to estimate the latest value of a hidden state given all previous observations. However, if we wait until the next observation arrives, we can often make a much better estimate - we now know where the state is going as well as where it came from. This is the idea exploited by the Kalman smoother. In fact, as we have seen, the regular particle filter gives us an estimate of the entire state history, $X_{1:t}$. However, due to the resampling process, the particle diversity of the state approximation for previous frames falls as we move further back in time.

A further disadvantage of this falling diversity in a tracking context is a tendency to lose tracks. Suppose that in some frame the majority of particles associate with a particular likely-looking observation and head off in one direction, but that a few frames later it becomes apparent that this is an error, and that the correct route goes another way. With an ordinary SISR particle filter the majority of the particles are now eliminated by resampling. The particle diversity of the state estimate will be very poor, and in a challenging problem there is a good chance that the track will be lost.

Improved estimates for previous state distributions can be made using the resample-move (RM) method of \cite{Gilks2001} to rejuvenate the particle diversity. However, this requires running at least one MH move for each particle on top of the usual importance sampling step, which will be computationally expensive. Furthermore, the RM steps will cause most rejuvenation in the most recent frames, which will be discarded in the next frame.

An alternative framework for fixed lag estimation is presented by \cite{Doucet2006}. Now we propose new values not only for the current state but also the previous states within some time window. The effect of this in our tracking example is that we can `redirect' particles which have gone astray along the correct path, maintaining a better particle diversity and reducing the probability of track loss. \cite{Doucet2006} report that RM does not perform as well as their fixed-lag estimation method, although the two schemes are related.

\begin{figure} \centering
\input{Rerouting.pdf_tex}%
\caption{An example of particle redirecting. Hidden states shown as blue crosses. Observations shown as red circles. FA and MD indicate a false alarm and missed detection respectively. After four time steps, the path shown in green dots is most likely. After two further steps, the most likely path is correct, shown in green dashes.}
\label{fig:Rerouting}%
\end{figure}